{"ast":null,"code":"var _jsxFileName = \"E:\\\\1\\\\curswork\\\\curswork - JSJSJSJSJS\\\\src\\\\components\\\\Tooltip\\\\Controller.tsx\";\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { createPortal } from 'react-dom';\nimport { Map } from 'immutable';\nimport { Trigger } from './Trigger';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst TOOLTIP_ROOT = document.getElementById('tooltip-root');\nexport class Controller extends React.PureComponent {\n  constructor(...args) {\n    super(...args);\n    this.tooltip = /*#__PURE__*/React.createRef();\n    this.trigger = /*#__PURE__*/React.createRef();\n    this.state = {\n      isVisible: false,\n      tooltipDimensions: Map({\n        width: 0,\n        height: 0\n      }),\n      style: Map({\n        position: 'absolute',\n        left: 0,\n        top: 0,\n        opacity: 0\n      }),\n      triggerRect: Map({\n        left: 0,\n        top: 0,\n        width: 0,\n        height: 0\n      })\n    };\n    this.handleMouseEnter = () => {\n      // TODO: cache this even for url transition (?), it's \"expensive\" and triggers reflow\n      const {\n        width,\n        height,\n        top,\n        left\n      } = ReactDOM.findDOMNode(this.trigger.current).getBoundingClientRect();\n      this.setState({\n        isVisible: true,\n        triggerRect: this.state.triggerRect.merge({\n          width,\n          height,\n          top,\n          left\n        })\n      });\n    };\n    this.handleMouseLeave = () => {\n      this.setState({\n        isVisible: false\n      });\n    };\n    this.getPosition = (tooltipDimensions = this.state.tooltipDimensions) => {\n      return calculatePosition(this.props.position, this.state.triggerRect, tooltipDimensions);\n    };\n    this.updateTriggerRect = triggerRect => {\n      this.setState({\n        triggerRect: this.state.triggerRect.merge(triggerRect),\n        style: this.state.style.set('opacity', 1)\n      });\n    };\n  }\n  componentDidUpdate() {\n    if (this.state.isVisible) {\n      const {\n        width,\n        height\n      } = ReactDOM.findDOMNode(this.tooltip.current).getBoundingClientRect();\n      const {\n        style,\n        tooltipDimensions\n      } = this.state;\n      const newTooltipDimensions = tooltipDimensions.merge({\n        width,\n        height\n      });\n      this.setState({\n        tooltipDimensions: newTooltipDimensions,\n        style: style.merge({\n          ...this.getPosition(newTooltipDimensions)\n        })\n      });\n    }\n  }\n  render() {\n    const {\n      children\n    } = this.props;\n    const {\n      isVisible,\n      style\n    } = this.state;\n    return React.Children.map(children, child => {\n      if (child.type === Trigger) {\n        return /*#__PURE__*/React.cloneElement(child, {\n          ref: this.trigger,\n          resize: this.updateTriggerRect,\n          onMouseEnter: this.handleMouseEnter,\n          onMouseLeave: this.handleMouseLeave\n        });\n      } else {\n        // Tooltip\n        return isVisible && /*#__PURE__*/createPortal( /*#__PURE__*/_jsxDEV(\"span\", {\n          style: style.toJS(),\n          ref: this.tooltip,\n          children: /*#__PURE__*/React.cloneElement(child)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 11\n        }, this), TOOLTIP_ROOT);\n      }\n    });\n  }\n}\nController.defaultProps = {\n  position: 'top-right'\n};\nconst TOOLTIP_BOUNDING_PADDING = 10;\nconst calculatePosition = (pos, trigger, tooltip) => {\n  const {\n    innerWidth: windowWidth\n  } = window;\n  let top = 0;\n  let left = 0;\n  const triggerTop = trigger.get('top') + window.pageYOffset;\n  const triggerLeft = trigger.get('left') + window.pageXOffset;\n\n  // Top\n  switch (pos) {\n    case 'top-left':\n    case 'top-right':\n      {\n        top = triggerTop - (tooltip.get('height') + 5);\n        break;\n      }\n    case 'bottom-left':\n    case 'bottom-right':\n      {\n        top = triggerTop + trigger.get('height') + 5;\n        break;\n      }\n  }\n\n  // Left\n  switch (pos) {\n    case 'left':\n    case 'bottom-left':\n    case 'top-left':\n      {\n        left = triggerLeft - tooltip.get('width');\n        break;\n      }\n    case 'right':\n    case 'bottom-right':\n    case 'top-right':\n      {\n        left = triggerLeft + trigger.get('width');\n        break;\n      }\n  }\n  const overflowsRight = left + tooltip.get('width') + TOOLTIP_BOUNDING_PADDING > windowWidth;\n  const overflowsTop = top - (window.scrollY + TOOLTIP_BOUNDING_PADDING) < 0;\n\n  // Validate\n  switch (pos) {\n    case 'top-right':\n      {\n        if (overflowsRight && !overflowsTop) return calculatePosition('top-left', trigger, tooltip);\n        if (!overflowsRight && overflowsTop) return calculatePosition('bottom-right', trigger, tooltip);\n        if (overflowsRight && overflowsTop) return calculatePosition('bottom-left', trigger, tooltip);\n        break;\n      }\n    case 'top-left':\n      {\n        break;\n      }\n  }\n  return {\n    top,\n    left\n  };\n};","map":{"version":3,"names":["React","ReactDOM","createPortal","Map","Trigger","jsxDEV","_jsxDEV","TOOLTIP_ROOT","document","getElementById","Controller","PureComponent","constructor","args","tooltip","createRef","trigger","state","isVisible","tooltipDimensions","width","height","style","position","left","top","opacity","triggerRect","handleMouseEnter","findDOMNode","current","getBoundingClientRect","setState","merge","handleMouseLeave","getPosition","calculatePosition","props","updateTriggerRect","set","componentDidUpdate","newTooltipDimensions","render","children","Children","map","child","type","cloneElement","ref","resize","onMouseEnter","onMouseLeave","toJS","fileName","_jsxFileName","lineNumber","columnNumber","defaultProps","TOOLTIP_BOUNDING_PADDING","pos","innerWidth","windowWidth","window","triggerTop","get","pageYOffset","triggerLeft","pageXOffset","overflowsRight","overflowsTop","scrollY"],"sources":["E:/1/curswork/curswork - JSJSJSJSJS/src/components/Tooltip/Controller.tsx"],"sourcesContent":["import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { createPortal } from 'react-dom'\nimport { Map } from 'immutable'\nimport { Trigger } from './Trigger';\n\nconst TOOLTIP_ROOT = document.getElementById('tooltip-root')\n\ninterface Props {\n  position?: TooltipPosition\n}\n\nexport class Controller extends React.PureComponent<Props> {\n  static defaultProps = {\n    position: 'top-right'\n  }\n\n  tooltip = React.createRef<HTMLSpanElement>()\n  trigger = React.createRef<React.ReactInstance>()\n\n  state = {\n    isVisible: false,\n    tooltipDimensions: Map({\n      width: 0,\n      height: 0\n    }),\n    style: Map({\n      position: 'absolute' as 'absolute',\n      left: 0,\n      top: 0,\n      opacity: 0,\n    }),\n    triggerRect: Map({\n      left: 0,\n      top: 0,\n      width: 0,\n      height: 0\n    })\n  }\n\n  handleMouseEnter = () => {\n    // TODO: cache this even for url transition (?), it's \"expensive\" and triggers reflow\n    const { width, height, top, left } = (ReactDOM.findDOMNode(this.trigger.current) as HTMLElement).getBoundingClientRect()\n\n    this.setState({ \n      isVisible: true,\n      triggerRect: this.state.triggerRect.merge({ width, height, top, left })\n    })\n  }\n\n  handleMouseLeave = () => {\n    this.setState({ isVisible: false })\n  }\n\n  componentDidUpdate() {\n    if (this.state.isVisible) {\n      const { width, height } = (ReactDOM.findDOMNode(this.tooltip.current) as HTMLElement).getBoundingClientRect()\n      const { style, tooltipDimensions } = this.state\n\n      const newTooltipDimensions = tooltipDimensions.merge({ width, height })\n      this.setState({\n        tooltipDimensions: newTooltipDimensions,\n        style: style.merge({ ...this.getPosition(newTooltipDimensions) })\n      })\n    }\n  }\n\n  getPosition = (tooltipDimensions = this.state.tooltipDimensions): { top: number, left: number } => {\n    return calculatePosition(this.props.position, this.state.triggerRect, tooltipDimensions)\n  }\n\n  updateTriggerRect = (triggerRect: { left: number, top: number, width: number, height: number }) => {\n    this.setState({\n      triggerRect: this.state.triggerRect.merge(triggerRect),\n      style: this.state.style.set('opacity', 1)\n    })\n  }\n\n  render() {\n    const { children } = this.props\n    const { isVisible, style } = this.state\n\n    return React.Children.map(children, (child: React.ReactElement) => {\n      if (child.type === Trigger) {\n        return React.cloneElement(child, {\n          ref: this.trigger,\n          resize: this.updateTriggerRect,\n          onMouseEnter: this.handleMouseEnter,\n          onMouseLeave: this.handleMouseLeave,\n        })\n      } else {\n        // Tooltip\n        return isVisible && createPortal(\n          <span style={style.toJS()} ref={this.tooltip}>\n            {React.cloneElement(child)}\n          </span>, \n          TOOLTIP_ROOT\n        )\n      }\n    })\n  }\n}\n\nconst TOOLTIP_BOUNDING_PADDING = 10\n\nconst calculatePosition = (pos: TooltipPosition, trigger: Map<string, number>, tooltip: Map<string, number>) => {\n  const { innerWidth: windowWidth } = window\n  let top = 0\n  let left = 0\n\n  const triggerTop = trigger.get('top') + window.pageYOffset\n  const triggerLeft = trigger.get('left') + window.pageXOffset\n\n  // Top\n  switch (pos) {\n    case 'top-left': \n    case 'top-right': {\n      top = triggerTop - (tooltip.get('height') + 5)\n      break\n    }\n\n    case 'bottom-left':\n    case 'bottom-right': {\n      top = triggerTop + trigger.get('height') + 5\n      break\n    }\n  }\n\n  // Left\n  switch (pos) {\n    case 'left':\n    case 'bottom-left':\n    case 'top-left': {\n      left = triggerLeft - tooltip.get('width')\n      break\n    }\n\n    case 'right': \n    case 'bottom-right':\n    case 'top-right': {\n      left = triggerLeft + trigger.get('width')\n      break\n    }\n  }\n\n  const overflowsRight = left + tooltip.get('width') + TOOLTIP_BOUNDING_PADDING > windowWidth\n  const overflowsTop = top - (window.scrollY + TOOLTIP_BOUNDING_PADDING) < 0\n\n  // Validate\n  switch (pos) {\n    case 'top-right': {\n      if (overflowsRight && !overflowsTop) return calculatePosition('top-left', trigger, tooltip)\n      if (!overflowsRight && overflowsTop) return calculatePosition('bottom-right', trigger, tooltip)\n      if (overflowsRight && overflowsTop) return calculatePosition('bottom-left', trigger, tooltip)\n      break\n    }\n\n    case 'top-left': {\n      break\n    }\n  }\n\n  return { top, left }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}